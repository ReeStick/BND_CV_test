# YOLOv8 Обработка видео для обнаружения людей

Этот проект предназначен для обнаружения и обозначения людей на видео. Модель по умолчанию YOLOv8n.

## Требования

- Python 3.9+
- OpenCV
- Ultralytics YOLOv8

## Установка

### 1. Клонирование репозитория
Сначала клонируйте репозиторий к себе на компьютер:

```
git clone https://github.com/ReeStick/BND_CV_test.git
cd BND_CV_test
```

### 2. Установка зависимостей

Перед запуском скрипта установите необходимые зависимости:

```
pip install -r requirements.txt
```

## Запуск скрипта

Для обработки видео через командную строку используйте следующий синтаксис:

```
python main.py --input путь_к_входному_видео --model путь_к_модели --output путь_к_выходному_видео
```

### Примеры:

```
python main.py --input ./videos/input.mp4 --model yolov8n.pt --output ./videos/output.mp4
python main.py --input crowd.mp4
```

- `--input`: Путь к видеофайлу, который нужно обработать.
- `--model`: Путь к модели YOLOv8 (по умолчанию `yolov8n.pt`).
- `--output`: Путь к сохранению выходного видео (по умолчанию `output.mp4`).

## Запуск через Docker

### 1. Построение Docker образа

Для начала нужно собрать Docker-образ:

```
docker build -t yolo-video-processor .
```

### 2. Запуск контейнера

Запустите контейнер с передачей нужных аргументов:

```
docker run --rm -v /путь/к/видео:/app/videos yolo-video-processor --input /app/videos/input.mp4 --model yolov8n.pt --output /app/videos/output.mp4
```

- Опция `-v` используется для монтирования локальной директории с видеофайлами внутрь контейнера. Это позволяет контейнеру получать доступ к видео и сохранять результат на вашем компьютере.

### Примеры:

```
docker run --rm -v $(pwd)/videos:/app/videos yolo-video-processor --input /app/videos/input.mp4 --model yolov8n.pt --output /app/videos/output.mp4
```

В этом примере текущая директория с видеофайлами монтируется в контейнер, а входное и выходное видео находятся внутри директории `/videos`.

```
docker run --rm -v ${PWD}:/app yolo-video-processor --input crowd.mp4 --model yolov8n.pt --output output.mp4
```

Здесь видео находятся в верхней директории, рядом с dockerfile и main.py

---------------------------

## Возможные улучшения для точности

1. Использовать модели большего размера - YOLOv8s или YOLOv8m
2. Fine-tune модели на дополнительных датасетах
3. Передавать на вход модели оригинал изображения вместо сжатия до 640*640
4. Заняться подбором гиперпараметров (confidence)
5. Использовать модели с сегментацией (например yolov8s-seg.pt)
6. Пост-процессинг (ансамблирование)
7. Сравнить с другими версиями yolo (например с v10 или v11)

Некоторые методы замедлят работу программы, другие же потребуют больше времени для разработки
